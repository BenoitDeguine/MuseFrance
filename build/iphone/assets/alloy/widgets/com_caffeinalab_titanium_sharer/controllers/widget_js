function WPATH(e){var t=e.lastIndexOf("/"),i=-1===t?"com.caffeinalab.titanium.sharer/"+e:e.substring(0,t)+"/com.caffeinalab.titanium.sharer/"+e.substring(t+1);return i}function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function e(e){i.sharer_Cont.data=_.map(e,function(e){if(null==a[e])throw new Error(n+": No share system found with name "+e);var i=Ti.UI.createTableViewRow({driver:e,selectedBackgroundColor:"transparent"});return i.add(t.createController("button",a[e].args).getView()),i})}var t=new(require("alloy/widget"))("com.caffeinalab.titanium.sharer");this.__widgetId="com.caffeinalab.titanium.sharer",require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="widget",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,r={};i.__views.sharer_Win=Ti.UI.createWindow({navBarHidden:!0,backgroundColor:"#C000",id:"sharer_Win"}),i.__views.sharer_Win&&i.addTopLevelView(i.__views.sharer_Win),i.__views.sharer_Title=Ti.UI.createLabel({top:40,textid:"Share",textAlign:"center",color:"#fff",font:{fontSize:20},id:"sharer_Title"}),i.__views.sharer_Win.add(i.__views.sharer_Title),i.__views.sharer_Hr=Ti.UI.createView({top:80,height:1,left:30,right:30,backgroundColor:"#9FFF",id:"sharer_Hr"}),i.__views.sharer_Win.add(i.__views.sharer_Hr),i.__views.sharer_Cont=Ti.UI.createTableView({top:80,bottom:100,scrollable:!0,backgroundColor:"transparent",separatorColor:"transparent",id:"sharer_Cont"}),i.__views.sharer_Win.add(i.__views.sharer_Cont),i.__views.sharer_Close=Ti.UI.createButton({color:"#fff",backgroundColor:"transparent",bottom:30,image:WPATH("/images/close.png"),font:{fontSize:30},id:"sharer_Close"}),i.__views.sharer_Win.add(i.__views.sharer_Close),r.destroy=function(){},_.extend(i,i.__views);var n="com.caffeinalab.titanium.sharer";null==Ti.Trimethyl&&Ti.API.warn(n+": This widget require Trimethyl to be installed (https://github.com/CaffeinaLab/Trimethyl)");var o=null,a={facebook:{callback:function(e){require("T/sharer").facebook(e.shareObj)},args:{title:"  Facebook",image:WPATH("images/facebook.png"),backgroundColor:"#3b5998",borderWidth:.5,borderColor:"#2B406E"}},twitter:{callback:function(e){require("T/sharer").twitter(e.shareObj)},args:{title:"  Twitter",image:WPATH("images/twitter.png"),backgroundColor:"#55acee",borderWidth:.5,borderColor:"#147AC8"}},googleplus:{callback:function(e){require("T/sharer").googleplus(e.shareObj)},args:{title:"  Google+",image:WPATH("images/googleplus.png"),backgroundColor:"#dd4b39",borderWidth:.5,borderColor:"#AE2E1E"}},whatsapp:{callback:function(e){require("T/sharer").whatsapp(e.shareObj)},args:{title:" Whatsapp",image:WPATH("images/whatsapp.png"),borderColor:"#fff"}},email:{callback:function(e){require("T/sharer").email(e.shareObj)},args:{title:" Email",image:WPATH("images/email.png"),borderColor:"#fff"}},message:{callback:function(e){require("T/sharer").message(e.shareObj)},args:{title:" "+L("Message"),image:WPATH("images/message.png"),borderColor:"#fff"}},copytoclipboard:{callback:function(e){Ti.UI.Clipboard.setText(e.shareObj.url),e.source.title=" "+L("link_copied","Link copied!")},args:{title:" "+L("copy_link","Copy link"),image:WPATH("images/copytoclipboard.png"),borderColor:"#fff"}}};r.setDriver=function(e,t){a[e]=t},r.extendDriverArgs=function(e,t){_.extend(a[e].args,t)},i.sharer_Cont.addEventListener("click",function(e){null!=e.rowData.driver&&a[e.rowData.driver].callback({shareObj:o,source:e.source})}),i.sharer_Close.addEventListener("click",function(){r.hide()}),r.show=function(t,r){if(null==t)throw new Error("Please set a sharing object");e(r||["facebook","twitter","googleplus","whatsapp","email","message","copytoclipboard"]),o=t,i.sharer_Win.opacity=0,i.sharer_Win.open(),i.sharer_Win.animate({opacity:1})},r.hide=function(){i.sharer_Win.close()},_.extend(i,r)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;